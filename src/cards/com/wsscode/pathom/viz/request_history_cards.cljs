(ns com.wsscode.pathom.viz.request-history-cards
  (:require [com.fulcrologic.guardrails.core :refer [>def >defn >fdef => | <- ?]]
            [com.wsscode.async.async-cljs :refer [let-chan go-promise <!]]
            [com.wsscode.pathom.viz.request-history :as request-history]
            [com.wsscode.pathom.viz.query-editor :as query.editor]
            [nubank.workspaces.card-types.fulcro3 :as ct.fulcro]
            [nubank.workspaces.core :as ws]
            [nubank.workspaces.model :as wsm]
            [com.wsscode.pathom.viz.helpers :as pvh]))

(def sample-trace
  (pvh/safe-read "{:start 0, :path [], :duration 263, :details [{:event \"trace-done\", :duration 0, :start 263}], :children [{:start 0, :path [:foreign->local], :duration 171, :details [{:event \"reader3-enter\", :duration 0, :start 1} {:event \"reader3-prepare-ast\", :duration 4, :start 4} {:event \"reader3-entity-shape\", :duration 0, :start 8} {:event \"reader3-execute\", :duration 175, :start 8, :style {:fill \"#6ac5ec\"}, :plan {:com.wsscode.pathom.connect.planner/nodes {1 {:com.wsscode.pathom.connect/sym foreign->foreign__GT_local, :com.wsscode.pathom.connect.planner/node-id 1, :com.wsscode.pathom.connect.planner/requires {:foreign->local {}}, :com.wsscode.pathom.connect.planner/input {:foreign {}}, :com.wsscode.pathom.connect.planner/after-nodes #{20}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign->local}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594051, :com.wsscode.pathom.connect/resolver-response {:foreign->local \"value\"}, :com.wsscode.pathom.connect/resolver-call-input {:foreign \"value\"}}]}, 2 {:com.wsscode.pathom.connect/sym dynamic-parser-6, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign :foreign-error}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.connect/resolver-call-input {}, :com.wsscode.pathom.connect/resolver-response {:foreign \"value\", :com.wsscode.pathom.core/errors {[:foreign-error] \"Foreign Error - {:error \\\"data\\\"}\"}}, :com.wsscode.pathom.trace/timestamp 1586370594012} {:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594016, :com.wsscode.pathom.connect/resolver-response {:foreign \"value\", :com.wsscode.pathom.core/errors {[:foreign-error] \"Foreign Error - {:error \\\"data\\\"}\"}}, :com.wsscode.pathom.connect/resolver-call-input {}}], :com.wsscode.pathom.connect.planner/source-sym foreign-constant, :com.wsscode.pathom.connect.planner/run-next 20, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/node-id 2, :com.wsscode.pathom.connect.planner/foreign-ast {:type :root, :children [{:type :prop, :dispatch-key :foreign, :key :foreign} {:type :prop, :dispatch-key :foreign-error, :key :foreign-error}]}, :com.wsscode.pathom.connect.planner/after-nodes #{17}, :com.wsscode.pathom.connect.planner/requires {:foreign {}, :foreign-error {}}}, 3 {:com.wsscode.pathom.connect/sym maybe-error-error, :com.wsscode.pathom.connect.planner/node-id 3, :com.wsscode.pathom.connect.planner/requires {:maybe-error {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/after-nodes #{5}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.connect/resolver-error #error {:message \"Sync Error\", :data {:error \"data\"}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594041, :com.wsscode.pathom.connect/resolver-call-input {}}]}, 4 {:com.wsscode.pathom.connect/sym maybe-error-success, :com.wsscode.pathom.connect.planner/node-id 4, :com.wsscode.pathom.connect.planner/requires {:maybe-error {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/after-nodes #{5}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594056, :com.wsscode.pathom.connect/resolver-response {:maybe-error \"value\"}, :com.wsscode.pathom.connect/resolver-call-input {}}]}, 5 {:com.wsscode.pathom.connect.planner/node-id 5, :com.wsscode.pathom.connect.planner/requires {:maybe-error {}}, :com.wsscode.pathom.connect.planner/run-or #{3 4}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:maybe-error}, :com.wsscode.pathom.connect.planner/after-nodes #{17}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/or-node-run, :com.wsscode.pathom.trace/timestamp 1586370594007}]}, 7 {:com.wsscode.pathom.connect/sym multi-dep-error, :com.wsscode.pathom.connect.planner/node-id 7, :com.wsscode.pathom.connect.planner/requires {:multi-dep-error {}}, :com.wsscode.pathom.connect.planner/input {:answer {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/after-nodes #{11}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:multi-dep-error}}, 8 {:com.wsscode.pathom.connect/sym answer-constant, :com.wsscode.pathom.connect.planner/node-id 8, :com.wsscode.pathom.connect.planner/requires {:answer {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:answer}, :com.wsscode.pathom.connect.planner/after-nodes #{11 17}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594029, :com.wsscode.pathom.connect/resolver-response {:answer 42}, :com.wsscode.pathom.connect/resolver-call-input {}} {:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594038, :com.wsscode.pathom.connect/resolver-response {:answer 42}, :com.wsscode.pathom.connect/resolver-call-input {}}]}, 9 {:com.wsscode.pathom.connect/sym error-with-dep, :com.wsscode.pathom.connect.planner/node-id 9, :com.wsscode.pathom.connect.planner/requires {:error-with-dep {}}, :com.wsscode.pathom.connect.planner/input {:pi {}}, :com.wsscode.pathom.connect.planner/after-nodes #{15}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:error-with-dep}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.connect/resolver-error #error {:message \"Sync Error\", :data {:error \"data\"}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594057, :com.wsscode.pathom.connect/resolver-call-input {:pi 3.141592653589793}} {:com.wsscode.pathom.connect/resolver-error #error {:message \"Sync Error\", :data {:error \"data\"}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594059, :com.wsscode.pathom.connect/resolver-call-input {:pi 3.141592653589793}} {:com.wsscode.pathom.connect/resolver-error #error {:message \"Sync Error\", :data {:error \"data\"}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594063, :com.wsscode.pathom.connect/resolver-call-input {:pi 3.141592653589793}}]}, 10 {:com.wsscode.pathom.connect/sym pi-constant, :com.wsscode.pathom.connect.planner/node-id 10, :com.wsscode.pathom.connect.planner/requires {:pi {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:pi}, :com.wsscode.pathom.connect.planner/run-next 15, :com.wsscode.pathom.connect.planner/after-nodes #{11 16 17}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594027, :com.wsscode.pathom.connect/resolver-response {:pi 3.141592653589793}, :com.wsscode.pathom.connect/resolver-call-input {}} {:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594033, :com.wsscode.pathom.connect/resolver-response {:pi 3.141592653589793}, :com.wsscode.pathom.connect/resolver-call-input {}} {:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594036, :com.wsscode.pathom.connect/resolver-response {:pi 3.141592653589793}, :com.wsscode.pathom.connect/resolver-call-input {}}]}, 11 {:com.wsscode.pathom.connect.planner/node-id 11, :com.wsscode.pathom.connect.planner/requires {:pi {}, :answer {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/run-and #{10 8}, :com.wsscode.pathom.connect.planner/run-next 7, :com.wsscode.pathom.connect.planner/after-nodes #{17}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/and-node-run, :com.wsscode.pathom.trace/timestamp 1586370594006}]}, 13 {:com.wsscode.pathom.connect/sym tau-constant, :com.wsscode.pathom.connect.planner/node-id 13, :com.wsscode.pathom.connect.planner/requires {:tau {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/after-nodes #{16}}, 14 {:com.wsscode.pathom.connect/sym pi->tau-single-attr-transform, :com.wsscode.pathom.connect.planner/node-id 14, :com.wsscode.pathom.connect.planner/requires {:tau {}}, :com.wsscode.pathom.connect.planner/input {:pi {}}, :com.wsscode.pathom.connect.planner/after-nodes #{15}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594061, :com.wsscode.pathom.connect/resolver-response {:tau 6.283185307179586}, :com.wsscode.pathom.connect/resolver-call-input {:pi 3.141592653589793}} {:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594062, :com.wsscode.pathom.connect/resolver-response {:tau 6.283185307179586}, :com.wsscode.pathom.connect/resolver-call-input {:pi 3.141592653589793}} {:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594065, :com.wsscode.pathom.connect/resolver-response {:tau 6.283185307179586}, :com.wsscode.pathom.connect/resolver-call-input {:pi 3.141592653589793}}]}, 15 {:com.wsscode.pathom.connect.planner/node-id 15, :com.wsscode.pathom.connect.planner/requires {:error-with-dep {}, :tau {}}, :com.wsscode.pathom.connect.planner/run-and #{9 14}, :com.wsscode.pathom.connect.planner/after-nodes #{10}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/and-node-run, :com.wsscode.pathom.trace/timestamp 1586370594028} {:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/and-node-run, :com.wsscode.pathom.trace/timestamp 1586370594035} {:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/and-node-run, :com.wsscode.pathom.trace/timestamp 1586370594037}]}, 16 {:com.wsscode.pathom.connect.planner/node-id 16, :com.wsscode.pathom.connect.planner/requires {:tau {}}, :com.wsscode.pathom.connect.planner/run-or #{10 13}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:tau}, :com.wsscode.pathom.connect.planner/after-nodes #{17}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/or-node-run, :com.wsscode.pathom.trace/timestamp 1586370594004}]}, 17 {:com.wsscode.pathom.connect.planner/node-id 17, :com.wsscode.pathom.connect.planner/requires {:tau {}, :pi {}, :answer {}, :error-with-dep {}, :maybe-error {}, :foreign {}, :foreign-error {}, :com.wsscode.pathom/trace {}}, :com.wsscode.pathom.connect.planner/run-and #{16 11 5 2 10 8 21}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/and-node-run, :com.wsscode.pathom.trace/timestamp 1586370594003}]}, 18 {:com.wsscode.pathom.connect/sym foreign-error-dep, :com.wsscode.pathom.connect.planner/node-id 18, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}}, :com.wsscode.pathom.connect.planner/input {:foreign-error {}}, :com.wsscode.pathom.connect.planner/after-nodes #{20}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign-error-dep}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.connect/resolver-error #error {:message \"Insufficient resolver input\", :data {:entity {:foreign-error :com.wsscode.pathom.core/reader-error}}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594052, :com.wsscode.pathom.connect/resolver-call-input {}}]}, 20 {:com.wsscode.pathom.connect.planner/node-id 20, :com.wsscode.pathom.connect.planner/requires {:foreign->local {}, :foreign-error-dep {}}, :com.wsscode.pathom.connect.planner/run-and #{1 18}, :com.wsscode.pathom.connect.planner/after-nodes #{2}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/and-node-run, :com.wsscode.pathom.trace/timestamp 1586370594017}]}, 21 {:com.wsscode.pathom.connect/sym com.wsscode.pathom.trace/trace, :com.wsscode.pathom.connect.planner/node-id 21, :com.wsscode.pathom.connect.planner/requires {:com.wsscode.pathom/trace {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:com.wsscode.pathom/trace}, :com.wsscode.pathom.connect.planner/after-nodes #{17}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-success, :com.wsscode.pathom.trace/timestamp 1586370594040, :com.wsscode.pathom.connect/resolver-response {:com.wsscode.pathom/trace nil}, :com.wsscode.pathom.connect/resolver-call-input {}}]}}, :com.wsscode.pathom.connect.planner/index-syms {pi->tau-single-attr-transform #{14}, answer-constant #{8}, com.wsscode.pathom.trace/trace #{21}, foreign->foreign__GT_local #{1}, pi-constant #{10}, foreign-error-dep #{18}, maybe-error-success #{4}, dynamic-parser-6 #{2}, multi-dep-error #{7}, tau-constant #{13}, maybe-error-error #{3}, error-with-dep #{9}}, :com.wsscode.pathom.connect.planner/unreachable-syms #{}, :com.wsscode.pathom.connect.planner/unreachable-attrs #{}, :com.wsscode.pathom.connect.planner/index-attrs {:pi 10, :foreign->local 1, :foreign-error-dep 18, :multi-dep-error 7, :foreign-error 2, :answer 8, :com.wsscode.pathom/trace 21, :error-with-dep 9, :tau 16, :maybe-error 5, :foreign 2}, :com.wsscode.pathom.connect.planner/root 17}} {:event \"compute-plan\", :duration 109, :start 8, :plan {:com.wsscode.pathom.connect.planner/nodes {1 {:com.wsscode.pathom.connect/sym foreign->foreign__GT_local, :com.wsscode.pathom.connect.planner/node-id 1, :com.wsscode.pathom.connect.planner/requires {:foreign->local {}}, :com.wsscode.pathom.connect.planner/input {:foreign {}}, :com.wsscode.pathom.connect.planner/after-nodes #{20}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign->local}}, 2 {:com.wsscode.pathom.connect/sym dynamic-parser-6, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign :foreign-error}, :com.wsscode.pathom.connect.planner/source-sym foreign-constant, :com.wsscode.pathom.connect.planner/run-next 20, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/node-id 2, :com.wsscode.pathom.connect.planner/foreign-ast {:type :root, :children [{:type :prop, :dispatch-key :foreign, :key :foreign} {:type :prop, :dispatch-key :foreign-error, :key :foreign-error}]}, :com.wsscode.pathom.connect.planner/after-nodes #{17}, :com.wsscode.pathom.connect.planner/requires {:foreign {}, :foreign-error {}}}, 3 {:com.wsscode.pathom.connect/sym maybe-error-error, :com.wsscode.pathom.connect.planner/node-id 3, :com.wsscode.pathom.connect.planner/requires {:maybe-error {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/after-nodes #{5}}, 4 {:com.wsscode.pathom.connect/sym maybe-error-success, :com.wsscode.pathom.connect.planner/node-id 4, :com.wsscode.pathom.connect.planner/requires {:maybe-error {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/after-nodes #{5}}, 5 {:com.wsscode.pathom.connect.planner/node-id 5, :com.wsscode.pathom.connect.planner/requires {:maybe-error {}}, :com.wsscode.pathom.connect.planner/run-or #{3 4}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:maybe-error}, :com.wsscode.pathom.connect.planner/after-nodes #{17}}, 7 {:com.wsscode.pathom.connect/sym multi-dep-error, :com.wsscode.pathom.connect.planner/node-id 7, :com.wsscode.pathom.connect.planner/requires {:multi-dep-error {}}, :com.wsscode.pathom.connect.planner/input {:answer {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/after-nodes #{11}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:multi-dep-error}}, 8 {:com.wsscode.pathom.connect/sym answer-constant, :com.wsscode.pathom.connect.planner/node-id 8, :com.wsscode.pathom.connect.planner/requires {:answer {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:answer}, :com.wsscode.pathom.connect.planner/after-nodes #{11 17}}, 9 {:com.wsscode.pathom.connect/sym error-with-dep, :com.wsscode.pathom.connect.planner/node-id 9, :com.wsscode.pathom.connect.planner/requires {:error-with-dep {}}, :com.wsscode.pathom.connect.planner/input {:pi {}}, :com.wsscode.pathom.connect.planner/after-nodes #{15}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:error-with-dep}}, 10 {:com.wsscode.pathom.connect/sym pi-constant, :com.wsscode.pathom.connect.planner/node-id 10, :com.wsscode.pathom.connect.planner/requires {:pi {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:pi}, :com.wsscode.pathom.connect.planner/run-next 15, :com.wsscode.pathom.connect.planner/after-nodes #{11 16 17}}, 11 {:com.wsscode.pathom.connect.planner/node-id 11, :com.wsscode.pathom.connect.planner/requires {:pi {}, :answer {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/run-and #{10 8}, :com.wsscode.pathom.connect.planner/run-next 7, :com.wsscode.pathom.connect.planner/after-nodes #{17}}, 13 {:com.wsscode.pathom.connect/sym tau-constant, :com.wsscode.pathom.connect.planner/node-id 13, :com.wsscode.pathom.connect.planner/requires {:tau {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/after-nodes #{16}}, 14 {:com.wsscode.pathom.connect/sym pi->tau-single-attr-transform, :com.wsscode.pathom.connect.planner/node-id 14, :com.wsscode.pathom.connect.planner/requires {:tau {}}, :com.wsscode.pathom.connect.planner/input {:pi {}}, :com.wsscode.pathom.connect.planner/after-nodes #{15}}, 15 {:com.wsscode.pathom.connect.planner/node-id 15, :com.wsscode.pathom.connect.planner/requires {:error-with-dep {}, :tau {}}, :com.wsscode.pathom.connect.planner/run-and #{9 14}, :com.wsscode.pathom.connect.planner/after-nodes #{10}}, 16 {:com.wsscode.pathom.connect.planner/node-id 16, :com.wsscode.pathom.connect.planner/requires {:tau {}}, :com.wsscode.pathom.connect.planner/run-or #{10 13}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:tau}, :com.wsscode.pathom.connect.planner/after-nodes #{17}}, 17 {:com.wsscode.pathom.connect.planner/node-id 17, :com.wsscode.pathom.connect.planner/requires {:tau {}, :pi {}, :answer {}, :error-with-dep {}, :maybe-error {}, :foreign {}, :foreign-error {}, :com.wsscode.pathom/trace {}}, :com.wsscode.pathom.connect.planner/run-and #{16 11 5 2 10 8 21}}, 18 {:com.wsscode.pathom.connect/sym foreign-error-dep, :com.wsscode.pathom.connect.planner/node-id 18, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}}, :com.wsscode.pathom.connect.planner/input {:foreign-error {}}, :com.wsscode.pathom.connect.planner/after-nodes #{20}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign-error-dep}}, 20 {:com.wsscode.pathom.connect.planner/node-id 20, :com.wsscode.pathom.connect.planner/requires {:foreign->local {}, :foreign-error-dep {}}, :com.wsscode.pathom.connect.planner/run-and #{1 18}, :com.wsscode.pathom.connect.planner/after-nodes #{2}}, 21 {:com.wsscode.pathom.connect/sym com.wsscode.pathom.trace/trace, :com.wsscode.pathom.connect.planner/node-id 21, :com.wsscode.pathom.connect.planner/requires {:com.wsscode.pathom/trace {}}, :com.wsscode.pathom.connect.planner/input {}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:com.wsscode.pathom/trace}, :com.wsscode.pathom.connect.planner/after-nodes #{17}}}, :com.wsscode.pathom.connect.planner/index-syms {pi->tau-single-attr-transform #{14}, answer-constant #{8}, com.wsscode.pathom.trace/trace #{21}, foreign->foreign__GT_local #{1}, pi-constant #{10}, foreign-error-dep #{18}, maybe-error-success #{4}, dynamic-parser-6 #{2}, multi-dep-error #{7}, tau-constant #{13}, maybe-error-error #{3}, error-with-dep #{9}}, :com.wsscode.pathom.connect.planner/unreachable-syms #{}, :com.wsscode.pathom.connect.planner/unreachable-attrs #{}, :com.wsscode.pathom.connect.planner/index-attrs {:pi 10, :foreign->local 1, :foreign-error-dep 18, :multi-dep-error 7, :foreign-error 2, :answer 8, :com.wsscode.pathom/trace 21, :error-with-dep 9, :tau 16, :maybe-error 5, :foreign 2}, :com.wsscode.pathom.connect.planner/root 17}} {:event \"call-resolver\", :duration 3, :start 124, :key :foreign->local, :label \"dynamic-parser-6\", :input-data {}, :sym dynamic-parser-6} {:event \"call-resolver\", :duration 0, :start 136, :key :foreign->local, :label \"pi-constant\", :input-data {}, :sym pi-constant} {:event \"call-resolver\", :duration 0, :start 137, :key :foreign->local, :label \"answer-constant\", :input-data {}, :sym answer-constant} {:event \"call-resolver\", :duration 1, :start 138, :key :foreign->local, :label \"com.wsscode.pathom.trace/trace\", :input-data {}, :sym com.wsscode.pathom.trace/trace} {:event \"call-resolver\", :duration 0, :start 140, :key :foreign->local, :label \"maybe-error-error\", :input-data {}, :sym maybe-error-error, :error \"Sync Error - {:error \\\"data\\\"}\"} {:event \"call-resolver\", :duration 1, :start 158, :key :foreign->local, :label \"foreign->foreign__GT_local\", :input-data {:foreign \"value\"}, :sym foreign->foreign__GT_local} {:event \"call-resolver\", :duration 0, :start 165, :key :foreign->local, :label \"maybe-error-success\", :input-data {}, :sym maybe-error-success} {:event \"call-resolver\", :duration 1, :start 168, :key :foreign->local, :label \"error-with-dep\", :input-data {:pi 3.141592653589793}, :sym error-with-dep, :error \"Sync Error - {:error \\\"data\\\"}\"} {:event \"call-resolver\", :duration 1, :start 170, :key :foreign->local, :label \"pi->tau-single-attr-transform\", :input-data {:pi 3.141592653589793}, :sym pi->tau-single-attr-transform}], :name \":foreign->local\"} {:start 184, :path [:maybe-error], :duration 0, :details [], :name \":maybe-error\"} {:start 185, :path [:multi-dep-error], :duration 29, :details [{:event \"reader3-enter\", :duration 0, :start 186} {:event \"reader3-prepare-ast\", :duration 5, :start 191} {:event \"reader3-entity-shape\", :duration 1, :start 197} {:event \"reader3-execute\", :duration 13, :start 199, :style {:fill \"#6ac5ec\"}, :plan {:com.wsscode.pathom.connect.planner/nodes {1 {:com.wsscode.pathom.connect/sym multi-dep-error, :com.wsscode.pathom.connect.planner/node-id 1, :com.wsscode.pathom.connect.planner/requires {:multi-dep-error {}}, :com.wsscode.pathom.connect.planner/input {:answer {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/after-nodes #{2}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:multi-dep-error}}, 2 {:com.wsscode.pathom.connect/sym error-with-dep, :com.wsscode.pathom.connect.planner/node-id 2, :com.wsscode.pathom.connect.planner/requires {:error-with-dep {}}, :com.wsscode.pathom.connect.planner/input {:pi {}}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:error-with-dep}, :com.wsscode.pathom.connect.planner/run-next 1, :com.wsscode.pathom.connect.planner/after-nodes #{4}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.connect/resolver-error #error {:message \"Sync Error\", :data {:error \"data\"}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594096, :com.wsscode.pathom.connect/resolver-call-input {:pi 3.141592653589793}}]}, 3 {:com.wsscode.pathom.connect/sym foreign-error-dep, :com.wsscode.pathom.connect.planner/node-id 3, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}}, :com.wsscode.pathom.connect.planner/input {:foreign-error {}}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign-error-dep}, :com.wsscode.pathom.connect.planner/after-nodes #{4}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.connect/resolver-error #error {:message \"Insufficient resolver input\", :data {:entity {:foreign-error :com.wsscode.pathom.core/reader-error}}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594096, :com.wsscode.pathom.connect/resolver-call-input {}}]}, 4 {:com.wsscode.pathom.connect.planner/node-id 4, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/run-and #{3 2}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/and-node-run, :com.wsscode.pathom.trace/timestamp 1586370594095}]}}, :com.wsscode.pathom.connect.planner/index-syms {multi-dep-error #{1}, error-with-dep #{2}, foreign-error-dep #{3}}, :com.wsscode.pathom.connect.planner/unreachable-syms #{}, :com.wsscode.pathom.connect.planner/unreachable-attrs #{}, :com.wsscode.pathom.connect.planner/index-attrs {:error-with-dep 2, :multi-dep-error 1, :foreign-error-dep 3}, :com.wsscode.pathom.connect.planner/root 4}} {:event \"compute-plan\", :duration 9, :start 200, :plan {:com.wsscode.pathom.connect.planner/nodes {1 {:com.wsscode.pathom.connect/sym multi-dep-error, :com.wsscode.pathom.connect.planner/node-id 1, :com.wsscode.pathom.connect.planner/requires {:multi-dep-error {}}, :com.wsscode.pathom.connect.planner/input {:answer {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/after-nodes #{2}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:multi-dep-error}}, 2 {:com.wsscode.pathom.connect/sym error-with-dep, :com.wsscode.pathom.connect.planner/node-id 2, :com.wsscode.pathom.connect.planner/requires {:error-with-dep {}}, :com.wsscode.pathom.connect.planner/input {:pi {}}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:error-with-dep}, :com.wsscode.pathom.connect.planner/run-next 1, :com.wsscode.pathom.connect.planner/after-nodes #{4}}, 3 {:com.wsscode.pathom.connect/sym foreign-error-dep, :com.wsscode.pathom.connect.planner/node-id 3, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}}, :com.wsscode.pathom.connect.planner/input {:foreign-error {}}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign-error-dep}, :com.wsscode.pathom.connect.planner/after-nodes #{4}}, 4 {:com.wsscode.pathom.connect.planner/node-id 4, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/run-and #{3 2}}}, :com.wsscode.pathom.connect.planner/index-syms {multi-dep-error #{1}, error-with-dep #{2}, foreign-error-dep #{3}}, :com.wsscode.pathom.connect.planner/unreachable-syms #{}, :com.wsscode.pathom.connect.planner/unreachable-attrs #{}, :com.wsscode.pathom.connect.planner/index-attrs {:error-with-dep 2, :multi-dep-error 1, :foreign-error-dep 3}, :com.wsscode.pathom.connect.planner/root 4}} {:event \"reader3-enter\", :duration 0, :start 214}], :name \":multi-dep-error\"} {:start 218, :path [:tau], :duration 0, :details [], :name \":tau\"} {:start 219, :path [:pi], :duration 0, :details [], :name \":pi\"} {:start 220, :path [:answer], :duration 0, :details [], :name \":answer\"} {:start 224, :path [:foreign-error-dep], :duration 31, :details [{:event \"reader3-enter\", :duration 0, :start 227} {:event \"reader3-prepare-ast\", :duration 4, :start 231} {:event \"reader3-entity-shape\", :duration 1, :start 236} {:event \"reader3-execute\", :duration 13, :start 240, :style {:fill \"#6ac5ec\"}, :plan {:com.wsscode.pathom.connect.planner/nodes {1 {:com.wsscode.pathom.connect/sym multi-dep-error, :com.wsscode.pathom.connect.planner/node-id 1, :com.wsscode.pathom.connect.planner/requires {:multi-dep-error {}}, :com.wsscode.pathom.connect.planner/input {:answer {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/after-nodes #{2}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:multi-dep-error}}, 2 {:com.wsscode.pathom.connect/sym error-with-dep, :com.wsscode.pathom.connect.planner/node-id 2, :com.wsscode.pathom.connect.planner/requires {:error-with-dep {}}, :com.wsscode.pathom.connect.planner/input {:pi {}}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:error-with-dep}, :com.wsscode.pathom.connect.planner/run-next 1, :com.wsscode.pathom.connect.planner/after-nodes #{4}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.connect/resolver-error #error {:message \"Sync Error\", :data {:error \"data\"}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594137, :com.wsscode.pathom.connect/resolver-call-input {:pi 3.141592653589793}}]}, 3 {:com.wsscode.pathom.connect/sym foreign-error-dep, :com.wsscode.pathom.connect.planner/node-id 3, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}}, :com.wsscode.pathom.connect.planner/input {:foreign-error {}}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign-error-dep}, :com.wsscode.pathom.connect.planner/after-nodes #{4}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.connect/resolver-error #error {:message \"Insufficient resolver input\", :data {:entity {:foreign-error :com.wsscode.pathom.core/reader-error}}}, :com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/node-resolver-error, :com.wsscode.pathom.trace/timestamp 1586370594137, :com.wsscode.pathom.connect/resolver-call-input {}}]}, 4 {:com.wsscode.pathom.connect.planner/node-id 4, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/run-and #{3 2}, :com.wsscode.pathom.connect.planner/node-trace [{:com.wsscode.pathom.trace/event :com.wsscode.pathom.connect/and-node-run, :com.wsscode.pathom.trace/timestamp 1586370594136}]}}, :com.wsscode.pathom.connect.planner/index-syms {multi-dep-error #{1}, error-with-dep #{2}, foreign-error-dep #{3}}, :com.wsscode.pathom.connect.planner/unreachable-syms #{}, :com.wsscode.pathom.connect.planner/unreachable-attrs #{}, :com.wsscode.pathom.connect.planner/index-attrs {:error-with-dep 2, :multi-dep-error 1, :foreign-error-dep 3}, :com.wsscode.pathom.connect.planner/root 4}} {:event \"compute-plan\", :duration 9, :start 241, :plan {:com.wsscode.pathom.connect.planner/nodes {1 {:com.wsscode.pathom.connect/sym multi-dep-error, :com.wsscode.pathom.connect.planner/node-id 1, :com.wsscode.pathom.connect.planner/requires {:multi-dep-error {}}, :com.wsscode.pathom.connect.planner/input {:answer {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/after-nodes #{2}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:multi-dep-error}}, 2 {:com.wsscode.pathom.connect/sym error-with-dep, :com.wsscode.pathom.connect.planner/node-id 2, :com.wsscode.pathom.connect.planner/requires {:error-with-dep {}}, :com.wsscode.pathom.connect.planner/input {:pi {}}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:error-with-dep}, :com.wsscode.pathom.connect.planner/run-next 1, :com.wsscode.pathom.connect.planner/after-nodes #{4}}, 3 {:com.wsscode.pathom.connect/sym foreign-error-dep, :com.wsscode.pathom.connect.planner/node-id 3, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}}, :com.wsscode.pathom.connect.planner/input {:foreign-error {}}, :com.wsscode.pathom.connect.planner/source-for-attrs #{:foreign-error-dep}, :com.wsscode.pathom.connect.planner/after-nodes #{4}}, 4 {:com.wsscode.pathom.connect.planner/node-id 4, :com.wsscode.pathom.connect.planner/requires {:foreign-error-dep {}, :error-with-dep {}}, :com.wsscode.pathom.connect.planner/run-and #{3 2}}}, :com.wsscode.pathom.connect.planner/index-syms {multi-dep-error #{1}, error-with-dep #{2}, foreign-error-dep #{3}}, :com.wsscode.pathom.connect.planner/unreachable-syms #{}, :com.wsscode.pathom.connect.planner/unreachable-attrs #{}, :com.wsscode.pathom.connect.planner/index-attrs {:error-with-dep 2, :multi-dep-error 1, :foreign-error-dep 3}, :com.wsscode.pathom.connect.planner/root 4}} {:event \"reader3-enter\", :duration 0, :start 255}], :name \":foreign-error-dep\"} {:start 260, :path [:com.wsscode.pathom/trace], :duration 0, :details [], :name \":com.wsscode.pathom/trace\"}], :hint \"Query\"}"))

(ws/defcard request-history-card
  {::wsm/align ::wsm/stretch-flex}
  (ct.fulcro/fulcro-card
    {::ct.fulcro/root          request-history/RequestHistory
     ::ct.fulcro/initial-state {::request-history/requests
                                [{::request-history/request-id 1
                                  ::request-history/request    [:foo]
                                  ::request-history/response   {:foo "bar"}}
                                 {::request-history/request-id 2
                                  ::request-history/request    [:buz
                                                                :long :with-long-things-here :more
                                                                {:deep [:stuff {:included [:here]}]}]
                                  ::request-history/response   {:buz                      "baz"
                                                                :com.wsscode.pathom/trace sample-trace}}]}}))
